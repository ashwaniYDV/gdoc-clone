{"version":3,"sources":["TextEditor.js","App.js","index.js"],"names":["TOOLBAR_OPTIONS","header","list","script","indent","size","color","background","font","align","TextEditor","documentId","useParams","id","useState","socket","setSocket","quill","setQuill","useEffect","_socket","io","disconnect","handler","delta","updateContents","once","document","setContents","enable","emit","off","interval","setInterval","getContents","clearInterval","oldDelta","source","on","wrapperRef","useCallback","wrapper","innerHTML","editor","createElement","append","_quill","Quill","theme","modules","toolbar","disable","setText","className","ref","App","exact","path","to","uuidV4","ReactDOM","render","StrictMode","getElementById"],"mappings":"yOAMMA,EAAkB,CACpB,CAAC,OAAQ,SAAU,YAAa,UAChC,CAAC,QAAS,aAAc,cAExB,CAAC,CAAEC,OAAQ,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAG,KAC9B,CAAC,CAAEC,KAAM,WAAY,CAAEA,KAAM,WAC7B,CAAC,CAAEC,OAAQ,OAAQ,CAAEA,OAAQ,UAC7B,CAAC,CAAEC,OAAQ,MAAO,CAAEA,OAAQ,OAE5B,CAAC,CAAEC,KAAM,CAAC,SAAS,EAAO,QAAS,UAEnC,CAAC,CAAEC,MAAO,IAAM,CAAEC,WAAY,KAC9B,CAAC,CAAEC,KAAM,KACT,CAAC,CAAEC,MAAO,KAEV,CAAC,UAsGUC,EAjGI,WAAO,IACVC,EAAeC,cAAnBC,GADa,EAEOC,qBAFP,mBAEdC,EAFc,KAENC,EAFM,OAGKF,qBAHL,mBAGdG,EAHc,KAGPC,EAHO,KAMrBC,qBAAU,WACN,IAAMC,EAAUC,aAAG,oCAGnB,OAFAL,EAAUI,GAEH,WACHA,EAAQE,gBAEb,IAGHH,qBAAU,WACN,GAAKJ,GAAWE,GAAUN,EAA1B,CAEA,IAAMY,EAAU,SAACC,GACbP,EAAMQ,eAAeD,IAUzB,OAPAT,EAAOW,KAAK,iBAAiB,SAAAC,GACzBV,EAAMW,YAAYD,GAClBV,EAAMY,YAGVd,EAAOe,KAAK,eAAgBnB,GAErB,WACHI,EAAOgB,IAAI,kBAAmBR,OAEnC,CAACR,EAAQE,EAAON,IAGnBQ,qBAAU,WACN,GAAKJ,GAAWE,EAAhB,CAEA,IAAMe,EAAWC,aAAY,WACzBlB,EAAOe,KAAK,gBAAiBb,EAAMiB,iBA1CtB,KA6CjB,OAAO,WACHC,cAAcH,OAEnB,CAACjB,EAAQE,IAGZE,qBAAU,WACN,GAAKJ,GAAWE,EAAhB,CAEA,IAAMM,EAAU,SAACC,EAAOY,EAAUC,GACf,SAAXA,GAEJtB,EAAOe,KAAK,eAAgBN,IAKhC,OAFAP,EAAMqB,GAAG,cAAef,GAEjB,WACHN,EAAMc,IAAI,cAAeR,OAE9B,CAACR,EAAQE,IAGZE,qBAAU,WACN,GAAKJ,GAAWE,EAAhB,CAEA,IAAMM,EAAU,SAACC,GACbP,EAAMQ,eAAeD,IAKzB,OAFAT,EAAOuB,GAAG,kBAAmBf,GAEtB,WACHR,EAAOgB,IAAI,kBAAmBR,OAEnC,CAACR,EAAQE,IAGZ,IAAMsB,EAAaC,uBAAY,SAACC,GAC5B,GAAKA,EAAL,CAEAA,EAAQC,UAAY,GACpB,IAAMC,EAAShB,SAASiB,cAAc,OACtCH,EAAQI,OAAOF,GACf,IAAMG,EAAS,IAAIC,IAAMJ,EAAQ,CAAEK,MAAO,OAAQC,QAAS,CAAEC,QAASlD,KAEtE8C,EAAOK,UACPL,EAAOjB,QAAO,GACdiB,EAAOM,QAAQ,cACflC,EAAS4B,MACV,IACH,OAAO,qBAAKO,UAAU,YAAYC,IAAKf,KCrG5BgB,EAfH,WACV,OACE,cAAC,IAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,IAAlB,SACE,cAAC,IAAD,CAAUC,GAAE,qBAAiBC,mBAE/B,cAAC,IAAD,CAAOH,OAAK,EAACC,KAAK,iBAAlB,SACE,cAAC,EAAD,Y,MCPVG,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFnC,SAASoC,eAAe,W","file":"static/js/main.db8911f2.chunk.js","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react'\nimport Quill from 'quill'\nimport \"quill/dist/quill.snow.css\"\nimport { io } from 'socket.io-client'\nimport { useParams } from 'react-router-dom'\n\nconst TOOLBAR_OPTIONS = [\n    ['bold', 'italic', 'underline', 'strike'],         // toggled buttons\n    ['image', 'blockquote', 'code-block'],\n  \n    [{ header: [1, 2, 3, 4, 5, 6, false] }],           // custom button values\n    [{ list: 'ordered'}, { list: 'bullet' }],\n    [{ script: 'sub'}, { script: 'super' }],           // superscript/subscript\n    [{ indent: '-1'}, { indent: '+1' }],               // outdent/indent\n  \n    [{ size: ['small', false, 'large', 'huge'] }],     // custom dropdown\n  \n    [{ color: [] }, { background: [] }],               // dropdown with defaults from theme\n    [{ font: [] }],\n    [{ align: [] }],\n\n    ['clean']                                          // remove formatting button\n];\n\nconst SAVE_INTERVAL_MS = 2000\n\nconst TextEditor = () => {\n    const { id: documentId } = useParams()\n    const [socket, setSocket] = useState()\n    const [quill, setQuill] = useState()\n\n    // handle connection\n    useEffect(() => {\n        const _socket = io('https://ashwanidoc.herokuapp.com')\n        setSocket(_socket)\n\n        return () => {\n            _socket.disconnect()\n        }\n    }, [])\n\n    // get document\n    useEffect(() => {\n        if (!socket || !quill || !documentId) return\n\n        const handler = (delta) => {\n            quill.updateContents(delta)\n        }\n\n        socket.once('load-document', document => {\n            quill.setContents(document)\n            quill.enable()\n        })\n\n        socket.emit('get-document', documentId)\n\n        return () => {\n            socket.off('receive-changes', handler)\n        }\n    }, [socket, quill, documentId])\n\n    // save document\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const interval = setInterval(() => {\n            socket.emit('save-document', quill.getContents())\n        }, SAVE_INTERVAL_MS)\n\n        return () => {\n            clearInterval(interval)\n        }\n    }, [socket, quill])\n\n    // send delta\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const handler = (delta, oldDelta, source) => {\n            if (source !== 'user') return\n\n            socket.emit('send-changes', delta)\n        }\n\n        quill.on('text-change', handler)\n\n        return () => {\n            quill.off('text-change', handler)\n        }\n    }, [socket, quill])\n\n    // receive delta\n    useEffect(() => {\n        if (!socket || !quill) return\n\n        const handler = (delta) => {\n            quill.updateContents(delta)\n        }\n\n        socket.on('receive-changes', handler)\n\n        return () => {\n            socket.off('receive-changes', handler)\n        }\n    }, [socket, quill])\n\n    // handle quill client\n    const wrapperRef = useCallback((wrapper) => {\n        if (!wrapper) return\n\n        wrapper.innerHTML = ''\n        const editor = document.createElement('div')\n        wrapper.append(editor)\n        const _quill = new Quill(editor, { theme: 'snow', modules: { toolbar: TOOLBAR_OPTIONS } })\n\n        _quill.disable()\n        _quill.enable(false)\n        _quill.setText('loading...')\n        setQuill(_quill)\n    }, [])\n    return <div className=\"container\" ref={wrapperRef}></div>\n}\n\nexport default TextEditor\n","import { BrowserRouter as Router, Switch, Route, Redirect } from 'react-router-dom'\nimport { v4 as uuidV4 } from 'uuid'\nimport TextEditor from './TextEditor'\n\nconst App = () => {\n  return (\n    <Router>\n      <Switch>\n        <Route exact path='/'>\n          <Redirect to={`/documents/${ uuidV4() }`} />\n        </Route>\n        <Route exact path='/documents/:id'>\n          <TextEditor />\n        </Route>\n      </Switch>\n    </Router>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport './styles.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n"],"sourceRoot":""}